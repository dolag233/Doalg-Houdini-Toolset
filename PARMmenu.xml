<?xml version="1.0" encoding="UTF-8"?>
<!--
    right-click menu of Dolag tools
-->
<menuDocument>
    <!-- menuDocument can only contain 1 menu element, whose id is 
         implicitly "root_menu"
      -->
    <menu>
        <subMenu id = "dolag.parm.menu">
            <label>Dolag</label>
            <scriptItem id = "dolag.parm.menu.save_snippet">
                <label>Save Snippet</label>
                    <scriptCode><![CDATA[
import hou
import sys
from parm_menu import save_snippet, save_window
from utils import show_UI
from utils.code_type import SnippetType, VexType
from error.error_report import displayError

parms = kwargs['parms']

for parm in parms:
    # just save snippet
    if parm.name() == 'snippet':
        code = parm.unexpandedString()
        if len(code) == 0:
            continue
        
        save_wind = show_UI.showUI(save_window.SaveWindow, SnippetType.vex)
        text = save_wind.getText()
        comment = save_wind.getComment()
        vex_type = save_wind.getVexType()
        if text is None:
            continue

        save_snippet.saveVEXToDisk(text, code, comment, vex_type)

    elif parm.name() == 'python':
        code = parm.unexpandedString()
        if len(code) == 0:
            continue
        
        save_wind = show_UI.showUI(save_window.SaveWindow, SnippetType.python)
        text = save_wind.getText()
        comment = save_wind.getComment()
        if text is None:
            continue

        save_snippet.savePythonToDisk(text, code, comment)

                    ]]>
                    </scriptCode>
            </scriptItem>

            <scriptItem id = "dolag.parm.menu.import_snippet">
                <label>Import Snippet</label>
                    <scriptCode><![CDATA[
import hou
import sys
from parm_menu import import_snippet, import_snippet_UI
from utils import show_UI
from utils.code_type import SnippetType, VexType

parms = kwargs['parms']

for parm in parms:
    # just save snippet
    if parm.name() == 'snippet':
        code = parm.unexpandedString()
        func_dict = import_snippet.searchVexList()
        import_wind = show_UI.showUI(import_snippet_UI.ImportWindow, func_dict, SnippetType.vex)
        import_snippet = import_wind.getSnippet()
        if import_snippet:
            code = import_snippet + code
        
        parm.set(code)

    elif parm.name() == 'python':
        code = parm.unexpandedString()
        func_dict = import_snippet.searchPythonList()
        import_wind = show_UI.showUI(import_snippet_UI.ImportWindow, func_dict, SnippetType.python)
        import_snippet = import_wind.getSnippet()
        if import_snippet:
            code = import_snippet + code

        parm.set(code)

                    ]]>
                    </scriptCode>
            </scriptItem>

            <scriptItem id = "dolag.parm.menu.copy_button">
                <label>Copy Button</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import copy_button

parms = kwargs['parms']
for parm in parms:
    if isinstance(parm.parmTemplate(), hou.ButtonParmTemplate):
        copy_button.copyButtonToClipboard(parm)
        break
                    ]]>
                    </scriptCode>
            </scriptItem>

            <scriptItem id = "dolag.parm.menu.paste_button">
                <label>Paste Button</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import copy_button

parms = kwargs['parms']
for parm in parms:
    if isinstance(parm.parmTemplate(), hou.ButtonParmTemplate):
        copy_button.pasteButtonFromClipboard(parm)
        break
                    ]]>
                    </scriptCode>
            </scriptItem>

            <subMenu id = "dolag.parm.menu.ramp_interpolation">
                <label>Set Ramp Interpolation</label>
                <scriptItem id = "dolag.parm.menu.ramp_interpolation.CatmullRom">
                    <label>CatmullRom</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import ramp_interpolation

parms = kwargs['parms']
for parm in parms:
    base = hou.rampBasis.CatmullRom
    ramp_interpolation.setRampInterpolation(parm, base)
                    ]]>
                    </scriptCode>
                </scriptItem>

                <scriptItem id = "dolag.parm.menu.ramp_interpolation.BSpline">
                    <label>BSpline</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import ramp_interpolation

parms = kwargs['parms']
for parm in parms:
    base = hou.rampBasis.BSpline
    ramp_interpolation.setRampInterpolation(parm, base)
                    ]]>
                    </scriptCode>
                </scriptItem>

                <scriptItem id = "dolag.parm.menu.ramp_interpolation.Bezier">
                    <label>Bezier</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import ramp_interpolation

parms = kwargs['parms']
for parm in parms:
    base = hou.rampBasis.Bezier
    ramp_interpolation.setRampInterpolation(parm, base)
                    ]]>
                    </scriptCode>
                </scriptItem>

                <scriptItem id = "dolag.parm.menu.ramp_interpolation.Constant">
                    <label>Constant</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import ramp_interpolation

parms = kwargs['parms']
for parm in parms:
    base = hou.rampBasis.Constant
    ramp_interpolation.setRampInterpolation(parm, base)
                    ]]>
                    </scriptCode>
                </scriptItem>

                <scriptItem id = "dolag.parm.menu.ramp_interpolation.Hermite">
                    <label>Hermite</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import ramp_interpolation

parms = kwargs['parms']
for parm in parms:
    base = hou.rampBasis.Hermite
    ramp_interpolation.setRampInterpolation(parm, base)
                    ]]>
                    </scriptCode>
                </scriptItem>

                <scriptItem id = "dolag.parm.menu.ramp_interpolation.Linear">
                    <label>Linear</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import ramp_interpolation

parms = kwargs['parms']
for parm in parms:
    base = hou.rampBasis.Linear
    ramp_interpolation.setRampInterpolation(parm, base)
                    ]]>
                    </scriptCode>
                </scriptItem>

                <scriptItem id = "dolag.parm.menu.ramp_interpolation.MonotoneCubic">
                    <label>MonotoneCubic</label>
                    <scriptCode><![CDATA[
import hou
from parm_menu import ramp_interpolation

parms = kwargs['parms']
for parm in parms:
    base = hou.rampBasis.MonotoneCubic
    ramp_interpolation.setRampInterpolation(parm, base)
                    ]]>
                    </scriptCode>
                </scriptItem>
            </subMenu>
        </subMenu>
    </menu>

</menuDocument>